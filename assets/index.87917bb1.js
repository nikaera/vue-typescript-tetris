var e=Object.defineProperty,t=("undefined"!=typeof require&&require,(t,n,r)=>(((t,n,r)=>{n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r})(t,"symbol"!=typeof n?n+"":n,r),r));import{r as n,o as r,c as o,p as s,a,d as l,u as i,b as c,e as d,f as u,t as p,g as f,w as m,v as y,F as h,h as v,n as b,i as g,j as k,k as w,l as x,m as _,q as A,s as L,x as I}from"./vendor.f9158da2.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const M={};M.render=function(e,t){const s=n("router-view");return r(),o(s)},s("data-v-4a611500");const q=u("h1",null,"トップ画面",-1),P=u("br",null,null,-1),C=u("br",null,null,-1);a();var S=l({setup(e){const t=i(),n=c({name:""});return(e,o)=>(r(),d(h,null,[q,u("p",null,p(f(n).name),1),m(u("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>f(n).name=e),placeholder:"名前を入力してください (10文字以内)",maxlength:"10"},null,512),[[y,f(n).name]]),P,C,u("button",{onClick:o[1]||(o[1]=e=>{t.push({name:"PlayPage",query:{name:n.name}})})}," ゲームスタート！ ")],64))}});S.__scopeId="data-v-4a611500";const j=[[[0]],[[1,1,1,1]],[[2,2],[2,2]],[[0,3,3],[3,3,0]],[[4,4,0],[0,4,4]],[[0,0,5],[5,5,5]],[[6,0,0],[6,6,6]],[[0,7,0],[7,7,7]]],E=1,$=2,F=3,N=4,T=5,U=6,D=7;class O{constructor(e){t(this,"type"),this.type=e}static id(e){switch(e){case E:return"block-i";case $:return"block-o";case F:return"block-s";case N:return"block-z";case T:return"block-j";case U:return"block-l";case D:return"block-t";default:return""}}get data(){return j[this.type]}static rotate(e,t){let n=t;for(let r=0;r<e;r++)n=n[0].map(((e,t)=>n.map((e=>e[t])).reverse()));return n}static empty(){return new O(0)}static random(){const e=j.length-1,t=Math.floor(Math.random()*e)+1;return new O(t)}}const R=class{constructor(e){if(t(this,"field"),t(this,"update",((e,t)=>{for(let n=0;n<e.length;n++){const r=e[n];for(let e=0;e<r.length;e++){const o=r[e];o>0&&(this.field[n+t.y][e+t.x]=o)}}})),t(this,"canMove",((e,t)=>{const n=this.field.length,r=this.field[0].length;if(t.y>=n)return!1;for(let o=0;o<e.length;o++){const s=e[o];for(let e=0;e<s.length;e++){if(s[e]>0&&(o+t.y>n-1||0>e+t.x||e+t.x>r-1||this.field[o+t.y][e+t.x]>0))return!1}}return!0})),e)this.field=e;else{const e=20,t=10,n=new Array(e);for(let r=0;r<e;r++){const e=new Array(t).fill(0);n[r]=e}this.field=n}}get data(){return this.field}};let z=R;t(z,"deepCopy",(e=>{const t=e.data,n=new Array(t.length);for(const[r,o]of t.entries()){n[r]=new Array(o.length);for(const[e]of o.entries())n[r][e]=t[r][e]}return new R(n)})),s("data-v-405fe94c");const K={class:"tetromino-preview"},V=u("label",null,"次のブロック",-1),B={class:"field",style:{"border-collapse":"collapse"}};a();var G=l({props:{tetromino:{type:Array,required:!0,default:void 0}},setup(e){const t=e;return(e,n)=>(r(),d("div",K,[V,u("table",B,[(r(!0),d(h,null,v(t.tetromino,((e,t)=>(r(),d("tr",{key:t},[(r(!0),d(h,null,v(e,((e,t)=>{return r(),d("td",{key:t,class:b(["block",(n=e,0===n?"no-block":O.id(n))])},null,2);var n})),128))])))),128))])]))}});G.__scopeId="data-v-405fe94c",s("data-v-2fb81398");const H=u("h1",null,"プレイ画面",-1),J={class:"container"},Q={class:"tetris"},W={class:"field",style:{"border-collapse":"collapse"}},X={class:"information"},Y={class:"data"},Z=["onClick"];a();var ee=l({setup(e){const t=1,n=2,o=3;let s=new z;const a=c({gameStatus:t}),l=c({field:new z,score:0});g(a,(e=>{switch(e.gameStatus){case t:break;case n:document.addEventListener("keydown",M),s=new z,l.field=new z,i.current=O.random(),i.next=O.random(),l.score=0,P();break;case o:document.removeEventListener("keydown",M),i.next=O.empty()}}));const i=c({current:O.empty(),position:{x:3,y:0},rotate:0,next:O.empty()}),m=()=>a.gameStatus=n,y=()=>O.rotate(i.rotate,i.current.data),A=(e,t)=>{const n=l.field.data[t][e];if(n>0)return O.id(n);const{x:r,y:o}=i.position,s=y();if(o<=t&&t<o+s.length){const n=s[t-o];if(r<=e&&e<r+n.length&&n[e-r]>0)return O.id(n[e-r])}return""},L=()=>{const{x:e,y:t}=i.position,n={x:e,y:t+1},r=y();return l.field.canMove(r,n)},I=()=>{const e=y(),t=i.position;l.field.update(e,t);const{field:n,score:r}=q();s=new z(n),l.field=z.deepCopy(s),l.score+=r,i.current=i.next,i.next=O.random(),i.rotate=0,i.position={x:3,y:0},L()||(a.gameStatus=o,P(!0))},M=e=>{switch(e.key){case" ":{const e=(i.rotate+1)%4,t=O.rotate(e,i.current.data);l.field.canMove(t,i.position)&&(i.rotate=e)}break;case"Down":case"ArrowDown":L()?(i.position.y++,P()):I();break;case"Up":case"ArrowUp":for(;L();)i.position.y++,P();I();break;case"Left":case"ArrowLeft":{const e=y(),{x:t,y:n}=i.position,r={x:t-1,y:n};l.field.canMove(e,r)&&i.position.x--}break;case"Right":case"ArrowRight":{const e=y(),{x:t,y:n}=i.position,r={x:t+1,y:n};l.field.canMove(e,r)&&i.position.x++}}},q=()=>{let e=0;const t=l.field.data.filter((t=>!t.every((e=>e>0))||(e++,!1)));for(let n=0;n<e;n++)t.unshift(new Array(t[0].length).fill(0));return{field:t,score:e}};k((()=>{document.removeEventListener("keydown",M)}));const P=(()=>{let e=-1;return(t=!1)=>{-1!==e&&clearInterval(e),t||(e=setInterval((()=>{l.field=z.deepCopy(s),L()?i.position.y++:I()}),1e3))}})();return(e,t)=>(r(),d(h,null,[H,u("h2",null,"ユーザ名: "+p(e.$route.query.name),1),u("div",J,[u("div",Q,[u("table",W,[(r(!0),d(h,null,v(f(l).field.data,((e,t)=>(r(),d("tr",{key:t},[(r(!0),d(h,null,v(e,((e,n)=>(r(),d("td",{key:()=>`${n}${t}${e}`,class:b(["block",A(n,t)])},null,2)))),128))])))),128))])]),u("div",X,[w(G,{tetromino:f(i).next.data},null,8,["tetromino"]),u("ul",Y,[u("li",null,"スコア: "+p(f(l).score),1),u("li",null,[a.gameStatus!==n?(r(),d("button",{key:0,onClick:x(m,["self","stop"])}," ゲームスタート ",8,Z)):_("",!0)])])])])],64))}});ee.__scopeId="data-v-2fb81398",s("data-v-886c913a");const te={class:"container"};a();var ne=l({setup(e){const t=[1,2,3,4,5,6,7].map((e=>new O(e).data));return(e,n)=>(r(),d("div",te,[(r(!0),d(h,null,v(f(t),(e=>(r(),d("div",null,[w(G,{tetromino:e},null,8,["tetromino"])])))),256))]))}});ne.__scopeId="data-v-886c913a",s("data-v-4a3e64e6");const re={class:"container"},oe={class:"tetris"},se={class:"field",style:{"border-collapse":"collapse"}};a();var ae=l({setup(e){const t=[[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,4,4,0,0,0,0,4,0,0],[0,0,4,4,0,0,4,4,0,0],[0,0,0,0,0,0,4,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,2,2,0,0,0,0,0],[0,0,0,2,2,0,0,0,0,0]],n=(e,n)=>{const r=t[n][e];return O.id(r)};return(e,o)=>(r(),d("div",re,[u("div",oe,[u("table",se,[(r(),d(h,null,v(t,((e,t)=>u("tr",null,[(r(!0),d(h,null,v(e,((e,o)=>(r(),d("td",{class:b(["block",n(o,t)])},null,2)))),256))]))),64))])])]))}});ae.__scopeId="data-v-4a3e64e6";const le=[{path:"/",name:"TopPage",component:S},{path:"/play",name:"PlayPage",component:ee},{path:"/tetromino_list",name:"TetrominoList",component:ne},{path:"/fixed_tetris_field",name:"FixedTetrisField",component:ae}],ie=A({history:L(),routes:le});I(M).use(ie).mount("#app");
